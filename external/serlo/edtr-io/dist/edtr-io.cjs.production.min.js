"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@edtr-io/core/beta"),n=require("@edtr-io/default-document-editor/beta"),r=require("@edtr-io/ui"),i=require("@serlo/i18n"),a=require("react"),l=e(a),o=require("@serlo/legacy-editor-to-editor"),c=require("ramda"),s=require("@edtr-io/plugin-text"),u=require("@edtr-io/plugin-anchor"),d=require("@edtr-io/plugin-blockquote"),m=require("@edtr-io/plugin-geogebra"),p=require("@edtr-io/plugin-highlight"),g=require("@edtr-io/plugin-input-exercise"),f=require("@edtr-io/plugin-multimedia-explanation"),h=require("@edtr-io/plugin-rows"),E=require("@edtr-io/plugin-sc-mc-exercise"),v=require("@edtr-io/plugin-spoiler"),x=require("@edtr-io/plugin-video"),b=require("@edtr-io/plugin"),y=require("@edtr-io/core"),w=require("@edtr-io/store"),C=e(require("react-bootstrap/lib/Alert")),S=e(require("react-bootstrap/lib/Modal")),I=e(require("react-bootstrap/lib/Button")),k=e(require("react-bootstrap/lib/Checkbox")),T=e(require("react-bootstrap/lib/FormGroup")),O=e(require("react-bootstrap/lib/ControlLabel")),F=e(require("react-bootstrap/lib/FormControl")),R=require("react-dom"),q=require("@fortawesome/free-solid-svg-icons/faHistory"),L=e(require("moment")),P=e(require("react-bootstrap/lib/Table")),N=e(require("unfetch")),D=require("@edtr-io/editor-ui/internal"),A=require("react-virtual"),_=require("@edtr-io/renderer-ui"),j=require("react-beautiful-dnd"),z=e(require("slate-plain-serializer")),M=require("slate-react"),B=require("styled-components"),H=e(B),G=require("@fortawesome/free-solid-svg-icons/faGraduationCap"),U=require("@fortawesome/free-solid-svg-icons"),W=require("@fortawesome/free-solid-svg-icons/faPlayCircle"),V=require("@edtr-io/math"),Y=require("@edtr-io/editor-ui"),X=require("@edtr-io/plugin-image"),J=require("@edtr-io/plugin-table"),K=require("@serlo/markdown"),Q=require("@serlo/mathjax"),$=require("@edtr-io/renderer"),Z=require("@edtr-io/plugin-text/internal"),ee=require("slate"),te=l.createContext((function(){return""}));function ne(){return(ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function re(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(i[n]=e[n]);return i}var ie=["content","text-solution","single-choice-right-answer","single-choice-wrong-answer","multiple-choice-right-answer","multiple-choice-wrong-answer","input-expression-equal-match-challenge","input-number-exact-match-challenge","input-string-normalized-match-challenge"],ae={plugin:"rows",state:[]};function le(e){var t=e.initialState,n=e.type,r=e.onError,i=[],a={applet:{deserialize:function(e){return i.push({id:e.id,type:"applet"}),{initialState:{plugin:"type-applet",state:ne({},e,{changes:"",title:e.title||"",url:e.url||"",content:se(ce(ue(e.content))),reasoning:se(ce(ue(e.reasoning))),meta_title:e.meta_title||"",meta_description:e.meta_description||""})},converted:!o.isEdtr(ue(e.content)||ae)}}},article:{deserialize:function(e){return i.push({id:e.id,type:"article"}),{initialState:{plugin:"type-article",state:ne({},e,{changes:"",title:e.title||"",content:(t=ue(e.content),n=ce(t),void 0!==t&&o.isEdtr(t)&&"article"===n.plugin?se(n):se({plugin:"article",state:{introduction:{plugin:"articleIntroduction"},content:n,exercises:[],exerciseFolder:{id:"",title:""},relatedContent:{articles:[],courses:[],videos:[]},sources:[]}})),reasoning:se(ce(ue(e.reasoning))),meta_title:e.meta_title||"",meta_description:e.meta_description||""})},converted:!o.isEdtr(ue(e.content)||ae)};var t,n}},course:{deserialize:function(e){return i.push({id:e.id,type:"course"}),{initialState:{plugin:"type-course",state:ne({},e,{changes:"",title:e.title||"",description:se(ce(ue(e.description))),reasoning:se(ce(ue(e.reasoning))),meta_description:e.meta_description||"","course-page":(e["course-page"]||[]).map((function(e){return l(e).initialState.state}))})},converted:!o.isEdtr(ue(e.description)||ae)}}},"course-page":{deserialize:l},event:{deserialize:function(e){return i.push({id:e.id,type:"event"}),{initialState:{plugin:"type-event",state:ne({},e,{changes:"",title:e.title||"",content:se(ce(ue(e.content))),meta_title:e.meta_title||"",meta_description:e.meta_description||""})},converted:!o.isEdtr(ue(e.content)||ae)}}},"math-puzzle":{deserialize:function(e){return i.push({id:e.id,type:"math-puzzle"}),{initialState:{plugin:"type-math-puzzle",state:ne({},e,{changes:"",content:se(ce(ue(e.content))),source:e.source||""})},converted:!o.isEdtr(ue(e.content)||ae)}}},page:{deserialize:function(e){return i.push({id:e.id,type:"page"}),{initialState:{plugin:"type-page",state:ne({},e,{title:e.title||"",content:se(ce(ue(e.content)))})},converted:!o.isEdtr(ue(e.content)||ae)}}},"grouped-text-exercise":{deserialize:s},"text-exercise":{deserialize:s},"text-exercise-group":{deserialize:function(e){return i.push({id:e.id,type:"text-exercise-group"}),{initialState:{plugin:"type-text-exercise-group",state:ne({},e,{changes:"",content:se(ce(ue(e.content))),cohesive:"true"===e.cohesive,"grouped-text-exercise":(e["grouped-text-exercise"]||[]).map((function(e){return s(e).initialState.state}))})},converted:!o.isEdtr(ue(e.content)||ae)}}},"text-solution":{deserialize:d},user:{deserialize:function(e){return i.push({id:e.id,type:"user"}),{initialState:{plugin:"type-user",state:ne({},e,{description:se(ce(ue(e.description)))})},converted:!1}}},video:{deserialize:function(e){return i.push({id:e.id,type:"video"}),{initialState:{plugin:"type-video",state:ne({},e,{changes:"",title:e.title||"",description:se(ce(ue(e.description))),content:e.content||"",reasoning:se(ce(ue(e.reasoning)))})},converted:!o.isEdtr(ue(e.description)||ae)}}},taxonomy:{deserialize:function(e){return i.push({id:e.id,type:"taxonomy"}),{initialState:{plugin:"type-taxonomy",state:ne({},e,{term:e.term,description:se(ce(ue(e.description)))})},converted:!1}}}};try{return void 0===a[n]?{error:"type-unsupported"}:ne({success:!0},(0,a[n].deserialize)(t))}catch(e){return"function"==typeof r&&r(e,{stack:JSON.stringify(i)}),{error:"failure"}}function l(e){return i.push({id:e.id,type:"course-page"}),{initialState:{plugin:"type-course-page",state:ne({},e,{changes:"",title:e.title||"",icon:e.icon||"explanation",content:se(ce(ue(e.content)))})},converted:!o.isEdtr(ue(e.content)||ae)}}function s(e){var t=e.content,n=e["text-solution"],r=e["single-choice-right-answer"],a=e["single-choice-wrong-answer"],l=e["multiple-choice-right-answer"],s=e["multiple-choice-wrong-answer"],m=e["input-expression-equal-match-challenge"],p=e["input-number-exact-match-challenge"],g=e["input-string-normalized-match-challenge"],f=re(e,ie);i.push({id:f.id,type:"text-exercise"});var h,E=ue(t),v=E&&!o.isEdtr(E)?function(){if(i.push({id:f.id,type:"sc-mc-exercise"}),a||r||s||l){var e=r&&r.content?[{content:u(o.convert(ue(r.content))),isCorrect:!0,feedback:u(o.convert(ue(r.feedback)))}]:[],t=a?a.filter((function(e){return e.content})).map((function(e){return{content:u(o.convert(ue(e.content))),isCorrect:!1,feedback:u(o.convert(ue(e.feedback)))}})):[],n=l?l.filter((function(e){return e.content})).map((function(e){return{content:u(o.convert(ue(e.content))),isCorrect:!0,feedback:{plugin:"text"}}})):[],c=s?s.filter((function(e){return e.content})).map((function(e){return{content:u(o.convert(ue(e.content))),isCorrect:!1,feedback:u(o.convert(ue(e.feedback)))}})):[],d=!(n.length||c.length);return{plugin:"scMcExercise",state:{isSingleChoice:d,answers:[].concat(d?e:[],d?t:[],d?[]:n,d?[]:c)}}}}():void 0,x=E&&!o.isEdtr(E)?function(){if(g||p||m)return{plugin:"inputExercise",state:{type:g?"input-string-normalized-match-challenge":p?"input-number-exact-match-challenge":"input-expression-equal-match-challenge",answers:function t(n,r){if(0===n.length)return[];var i=n.map((function(e){return{value:e.solution,feedback:u(o.convert(ue(e.feedback))),isCorrect:r}})),a=c.flatten(n.map((function(t){return e([t["input-string-normalized-match-challenge"],t["input-number-exact-match-challenge"],t["input-expression-equal-match-challenge"]])})));return c.concat(i,t(a,!1))}(e([g,p,m]),!0),unit:""}};function e(e){return e.filter((function(e){return void 0!==e}))}}():void 0;return{initialState:{plugin:"type-text-exercise",state:ne({},f,{changes:"","text-solution":n?d(n).initialState.state:"",content:(h=ue(t),void 0!==h&&o.isEdtr(h)?se(ce(h)):se({plugin:"exercise",state:{content:{plugin:"rows",state:ce(h).state},interactive:v||x}}))})},converted:!o.isEdtr(E||ae)}}function u(e){return e.state.length?e.state[0]:{plugin:"text"}}function d(e){return i.push({id:e.id,type:"text-solution"}),{initialState:{plugin:"type-text-solution",state:ne({},e,{changes:"",content:(t=ue(e.content),void 0!==t&&o.isEdtr(t)?se(ce(t)):se({plugin:"solution",state:{prerequisite:void 0,strategy:{plugin:"text"},steps:ce(t)}}))})},converted:!o.isEdtr(ue(e.content)||ae)};var t}}function oe(e){return!!e.error}function ce(e){return e?o.isEdtr(e)?e:o.convert(e):{plugin:"rows",state:[{plugin:"text",state:void 0}]}}function se(e){return"string"==typeof e?e:e?JSON.stringify(e):void 0}function ue(e){try{return e?JSON.parse(e):void 0}catch(t){return e}}var de=b.object({id:b.number(),title:b.string(),url:b.string(),agreement:b.string(),iconHref:b.string()}),me={id:b.number()},pe={license:de},ge=ne({},me,pe,{revision:b.number(),changes:b.string()}),fe=r.styled.input({border:"none",width:"100%",borderBottom:"2px solid transparent","&:focus":{outline:"none",borderColor:"#007ec1"}});function he(e){var t,n,r=i.useI18n(),l=y.useScopedStore(),o=y.useScopedDispatch(),s=y.useScopedSelector(w.hasUndoActions()),u=y.useScopedSelector(w.hasRedoActions()),d=0!==y.useScopedSelector(w.getPendingChanges()),m=a.useContext(te),p=a.useState(!1),g=p[0],f=p[1],h=a.useState(!1),E=h[0],v=h[1],x=a.useState(!1),b=x[0],q=x[1],L=a.useState(!1),P=L[0],N=L[1],D=a.useContext(sn),A=D.onSave,_=D.mayCheckout,j=a.useState(!1),z=j[0],M=j[1],B=a.useState(!0),H=B[0],G=B[1],U=a.useState(!0),W=U[0],V=U[1],Y=a.useState(!1),X=Y[0],J=Y[1];return a.useEffect((function(){g&&(v(!1),q(!1),N(!1),M(!1))}),[g]),a.useEffect((function(){window.onbeforeunload=d&&!E?function(){return""}:null}),[d,E]),a.createElement(a.Fragment,null,R.createPortal(a.createElement("div",{className:"btn-group btn-group-community"},a.createElement("button",{className:"btn btn-default",onClick:function(){o(w.undo())},disabled:!s},a.createElement("span",{className:"fa fa-undo"})),a.createElement("button",{className:"btn btn-default",onClick:function(){o(w.redo())},disabled:!u},a.createElement("span",{className:"fa fa-repeat"})),(n=e.changes||e.license||e.subscriptions?{onClick:function(){f(!0)},disabled:!d,children:a.createElement("span",{className:"fa fa-save"})}:{onClick:function(){Z()},disabled:!d||!$()||E,children:a.createElement("span",E?{className:"fa fa-spinner fa-spin"}:{className:"fa fa-save"})},a.createElement("button",Object.assign({className:"btn btn-success"},n)))),document.getElementsByClassName("controls")[0]),a.createElement(S,{show:g,onHide:function(){f(!1)}},a.createElement(S.Header,{closeButton:!0},a.createElement(S.Title,null,r.t("edtr-io::Save"))),a.createElement(S.Body,null,b?a.createElement(a.Fragment,null,a.createElement(C,{bsStyle:"danger",onDismiss:function(){q(!1)}},r.t("edtr-io::An error occurred during saving."),a.createElement("br",null),r.t("edtr-io::You can store the revision locally, refresh the page and try to save again.")),a.createElement(S.Footer,null,a.createElement(I,{bsStyle:"success",onClick:function(){un(w.serializeRootDocument()(l.getState())),N(!0)}},r.t(P?"edtr-io::Revision saved":"edtr-io::Save revision")))):null,(t=e.changes)?a.createElement(T,{controlId:"changes"},a.createElement(O,null,r.t("edtr-io::Changes")),a.createElement(F,{componentClass:"textarea",value:t.value,onChange:function(e){t.set(e.target.value)}})):null,function(){var t=e.license;return t?a.createElement(k,{checked:z,onChange:function(e){M(e.target.checked)}},a.createElement("span",{dangerouslySetInnerHTML:{__html:t.agreement.value}})):null}(),e.subscriptions?a.createElement(a.Fragment,null,a.createElement(k,{checked:W,onChange:function(e){V(e.target.checked)}},r.t("edtr-io::Enable serlo.org notifications")),a.createElement(k,{checked:H,onChange:function(e){G(e.target.checked)}},r.t("edtr-io::Enable notifications via e-mail"))):null,_?a.createElement(k,{checked:X,onChange:function(e){J(e.target.checked)}},r.t("edtr-io::Skip peer review (not recommended)")):null),a.createElement(S.Footer,null,a.createElement(I,{onClick:function(){f(!1)}},r.t("edtr-io::Cancel")),a.createElement(I,{onClick:function(){Z()},bsStyle:"success",disabled:!$()||E,title:function(){if(!$())return K()&&!Q()?r.t("edtr-io::You need to fill out the changes you made"):!K()&&Q()?r.t("edtr-io::You need to accept the license terms"):r.t("edtr-io::You need to fill out the changes you made and accept the license terms")}()},r.t(E?"edtr-io::Saving…":"edtr-io::Save")))));function K(){return!e.license||z}function Q(){return!e.changes||e.changes.value}function $(){return K()&&Q()}function Z(){if($()){var t=w.serializeRootDocument()(l.getState()),n=c.has("state",t)?t.state:null;null!==n&&"type-text-exercise-group"===(null==t?void 0:t.plugin)&&c.has("cohesive",n)&&(n.cohesive=String(n.cohesive)),v(!0),A(ne({},n,{csrf:m(),controls:ne({},e.subscriptions?{subscription:{subscribe:W?1:0,mailman:H?1:0}}:{},_?{checkout:X}:{})})).then((function(){un(void 0),v(!1),q(!1)})).catch((function(){v(!1),q(!0)}))}}}function Ee(e,t,n){var r=b.object(ne({},e,t),n);return ne({},r,{init:function(t,n){return ne({},r.init(t,n),{replaceOwnState:function(t){n((function(n,r){return c.mapObjIndexed((function(i,a){return a in e?e[a].deserialize(t[a],r):n[a]}),n)}))}})}})}function ve(e){void 0===e&&(e="rows");var t=b.child({plugin:e});return ne({},t,{serialize:function(){return JSON.stringify(t.serialize.apply(t,arguments))},deserialize:function(e,n){return t.deserialize(JSON.parse(e),n)}})}function xe(e){var t=b.child({plugin:e,config:{skipControls:!0}});return ne({},t,{serialize:function(){return t.serialize.apply(t,arguments).state},deserialize:function(n,r){return t.deserialize({plugin:e,state:n},r)}})}function be(e){var t=xe(e);return ne({},t,{init:function(e,n){return ne({},t.init(e,(function(e){n((function(t,n){return e(t||"",n)}))})),{create:function(e){n((function(n,r){return void 0!==e?t.deserialize(e,r):t.createInitialState(r)}))},remove:function(){n((function(){return null}))}})},serialize:function(e,n){return e?t.serialize(e,n):null},deserialize:function(e,n){return e?t.deserialize(e,n):null},createInitialState:function(){return null},getFocusableChildren:function(e){return e?[{id:e}]:[]}})}function ye(e){b.object(ge);var t=y.useScopedSelector(w.getDocument(e.state.id)),n=e.state.render({renderToolbar:function(n){return 0!==t.state.id?n:a.createElement(a.Fragment,null,a.createElement(y.PluginToolbarButton,{icon:a.createElement(r.Icon,{icon:r.faTrashAlt}),label:e.removeLabel,onClick:function(){e.onRemove()}}),n)}});return a.createElement(a.Fragment,null,a.createElement("hr",null),n)}var we=r.styled.tr((function(e){return e.selected?{border:"3px solid rgb(0,100,0)"}:{cursor:"pointer"}}));function Ce(e){var t=a.useState([]),n=t[0],l=t[1],o=i.useI18n(),c=a.useState(!1),s=c[0],u=c[1];return a.useEffect((function(){0!==e.id&&N("/entity/repository/get-revisions/"+e.id).then((function(e){return e.json()})).then((function(e){l(e)}))}),[e.id]),a.createElement("div",null,a.createElement("span",{onClick:function(){n.length&&u(!0)}},a.createElement(y.PluginToolbarButton,{icon:a.createElement(r.Icon,{icon:q.faHistory,size:"lg"}),label:o.t("edtr-io::Switch to another revision")})),a.createElement(S,{show:s,onHide:function(){u(!1)},bsSize:"lg"},a.createElement(S.Header,{closeButton:!0},a.createElement(S.Title,null,o.t("edtr-io::Switch to another revision"))),a.createElement(S.Body,null,a.createElement(P,{striped:!0,hover:!0},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"#"),a.createElement("th",null,o.t("edtr-io::Current")),a.createElement("th",null,o.t("edtr-io::Changes")),a.createElement("th",null,o.t("edtr-io::Author")),a.createElement("th",null,o.t("edtr-io::Created at")))),a.createElement("tbody",null,n.map((function(t){var n=e.currentRevision?e.currentRevision===t.id:t.active,i=L.utc(t.timestamp).local();return a.createElement(we,{selected:n,onClick:function(){n||N("/entity/repository/get-revision-data/"+e.id+"/"+t.id).then((function(e){return e.json()})).then((function(t){var n=le({initialState:t.state,type:t.type});oe(n)?alert(n.error):(e.onSwitchRevision(n.initialState.state),u(!1))}))},key:t.id},a.createElement("td",null,t.id),a.createElement("td",null,t.active?a.createElement(r.Icon,{icon:r.faCheck}):null),a.createElement("th",null,t.changes),a.createElement("td",null,t.author),a.createElement("td",{title:i.format("LL, LTS")},i.fromNow()))}))))),a.createElement(S.Footer,null,a.createElement(I,{onClick:function(){u(!1)}},"Schließen"))))}function Se(e){return a.createElement(a.Fragment,null,e.children)}Se.Textarea=function(e){var t=e.state;return a.createElement(T,null,a.createElement(O,null,e.label),a.createElement(F,{componentClass:"textarea",value:t.value,onChange:function(e){t.set(e.target.value)}}))},Se.Select=function(e){var t=e.state,n=e.options;return a.createElement(T,{controlId:"formControlsSelect"},a.createElement(O,null,e.label),a.createElement(F,{componentClass:"select",placeholder:"select",value:t.value,onChange:function(e){t.set(e.target.value)}},n.map((function(e){return a.createElement("option",{key:e.value,value:e.value},e.label)}))))};var Ie={Component:function(e){var t=e.state,n=t.title,r=t.url,l=t.content,o=t.meta_title,c=t.meta_description,s=i.useI18n();return a.createElement("div",null,a.createElement("div",{className:"page-header"},e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Textarea,{label:s.t("applet::Title for search engines"),state:o}),a.createElement(Se.Textarea,{label:s.t("applet::Description for search engines"),state:c}))),a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:s.t("applet::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value))),a.createElement("article",null,r.render(),l.render()),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{title:b.string(),content:ve(),reasoning:ve(),meta_title:b.string(),meta_description:b.string(),url:xe("geogebra")}),{}),config:{}},ke={Component:function(e){var t=e.state,n=t.title,r=t.content,l=t.meta_title,o=t.meta_description,c=i.useI18n();return a.createElement(a.Fragment,null,a.createElement("div",{className:"page-header"},e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Textarea,{label:c.t("article::Title for search engines"),state:l}),a.createElement(Se.Textarea,{label:c.t("article::Description for search engines"),state:o}))),a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:c.t("article::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value))),a.createElement("div",{itemProp:"articleBody"},r.render()),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{title:b.string(),content:ve("article"),reasoning:ve(),meta_title:b.string(),meta_description:b.string()}),{}),config:{}},Te={Component:function(e){var t=e.state,n=t.title,r=t.meta_description,l=t["course-page"],o=i.useI18n();return a.createElement("article",null,e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Textarea,{label:o.t("course::Description for search engines"),state:r}))),a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:o.t("course::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value)),l.map((function(e,t){return a.createElement(ye,{state:e,key:e.id,removeLabel:o.t("course::Remove course page"),onRemove:function(){l.remove(t)}})})),a.createElement("hr",null),a.createElement(D.AddButton,{onClick:function(){return l.insert()}},o.t("course::Add course page")),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{title:b.string(),description:ve(),reasoning:ve(),meta_description:b.string()}),{"course-page":b.list(xe("type-course-page"))}),config:{}},Oe={Component:function(e){var t=e.state,n=t.title,r=t.icon,l=t.content,o=i.useI18n();return a.useEffect((function(){["explanation","play","question"].includes(r.value)||r.set("explanation")}),[r.value]),a.createElement("article",null,e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Select,{label:"Icon",state:r,options:[{label:o.t("coursePage::Explanation"),value:"explanation"},{label:o.t("coursePage::Video"),value:"play"},{label:o.t("coursePage::Question"),value:"question"}]}))),a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:o.t("coursePage::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value)),l.render(),e.config.skipControls?null:a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{icon:b.string("explanation"),title:b.string(""),content:ve()}),{}),config:{skipControls:!1}},Fe={Component:function(e){var t=e.state,n=t.content,r=t.title,l=t.meta_title,o=t.meta_description,c=i.useI18n();return a.createElement(a.Fragment,null,a.createElement("div",{className:"page-header"},e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Textarea,{label:c.t("event::Title for search engines"),state:l}),a.createElement(Se.Textarea,{label:c.t("event::Description for search engines"),state:o}))),a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:c.t("event::Title"),value:r.value,onChange:function(e){r.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},r.value))),a.createElement("article",null,n.render()),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{title:b.string(),content:ve(),meta_title:b.string(),meta_description:b.string()}),{}),config:{}},Re={Component:function(e){var t=e.state,n=t.source,r=t.content,l=i.useI18n();return a.createElement(a.Fragment,null,e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),e.renderIntoSettings(a.createElement(Se,null,a.createElement(Se.Textarea,{label:l.t("mathPuzzle::Source code"),state:n}))),a.createElement("div",{className:"math-puzzle","data-source":n.value},r.render()),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{source:b.string(),content:ve()}),{}),config:{}},qe={Component:function(e){var t=e.state,n=t.title,r=t.content,l=i.useI18n();return a.createElement("article",null,a.createElement("header",null,a.createElement("div",{className:"page-header"},a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:l.t("page::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value)))),a.createElement("section",{itemProp:"articleBody"},r.render()),a.createElement(he,Object.assign({},e.state)))},state:b.object(ne({},me,pe,{title:b.string(),content:ve()})),config:{}},Le={Component:function(e){var t=e.state,n=t.term,r=t.description,l=i.useI18n();return a.createElement("article",null,a.createElement("header",null,a.createElement("div",{className:"page-header"},a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:l.t("taxonomy::Title"),value:n.name.value,onChange:function(e){n.name.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.name.value)))),a.createElement("section",{itemProp:"articleBody"},r.render()),a.createElement(he,null))},state:b.object(ne({},me,{term:b.object({name:b.string()}),taxonomy:b.number(),parent:b.number(),position:b.number(),description:ve()})),config:{}},Pe={Component:function(e){var t=e.state,n=t.content,r=t["text-solution"],l=i.useI18n();return a.createElement("article",{className:"text-exercise"},e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),n.render(),r.id?a.createElement(ye,{state:r,removeLabel:l.t("textExercise::Remove solution"),onRemove:function(){r.remove()}}):a.createElement(D.AddButton,{onClick:function(){r.create()}},l.t("textExercise::Create solution")),e.config.skipControls?null:a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{content:ve("exercise")}),{"text-solution":be("type-text-solution")}),config:{skipControls:!1}},Ne=r.styled.div({boxShadow:"0 1px 3px 0 rgba(0,0,0,0.2)",marginTop:"10px",padding:"10px",minHeight:"70px",position:"relative"});function De(e){var t=e.children;return e.editable?a.createElement(Ne,null,e.children):a.createElement(a.Fragment,null,t)}var Ae={Component:function(e){var t,n=e.state,r=n.cohesive,l=n.content,o=n["grouped-text-exercise"],c=i.useI18n(),s=null!=(t=r.value)&&t,u=a.useRef(null),d=A.useVirtual({size:o.length,parentRef:u,estimateSize:a.useCallback((function(){return 35}),[])}),m=l.render({renderSettings:function(e){return a.createElement(a.Fragment,null,e,a.createElement("div",null,a.createElement("label",{htmlFor:"cohesiveSelect"},c.t("textExerciseGroup::Kind of exercise group"),":")," ",a.createElement("select",{id:"cohesiveSelect",value:s?"cohesive":"non-cohesive",onChange:function(e){return r.set("cohesive"===e.target.value)}},a.createElement("option",{value:"non-cohesive"},c.t("textExerciseGroup::not cohesive")),a.createElement("option",{value:"cohesive"},c.t("textExerciseGroup::cohesive")))))}});return a.createElement("article",{className:"exercisegroup"},e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),a.createElement("section",{className:"row"},a.createElement(De,{editable:e.editable},m)),a.createElement("div",{ref:u,style:{height:"100%",overflow:"auto"}},a.createElement("div",{style:{height:d.totalSize+"px",width:"100%",position:"relative"}},d.virtualItems.map((function(e){var t,n=o[e.index];return a.createElement("div",{key:e.index,ref:e.measureRef,style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY("+e.start+"px)"}},a.createElement("section",{className:"row",key:n.id},a.createElement("div",{className:"col-sm-1 hidden-xs"},a.createElement("em",null,(t=e.index,s?t+1:String.fromCharCode(97+t)),")")),a.createElement("div",{className:"col-sm-11 col-xs-12"},a.createElement(ye,{state:n,removeLabel:c.t("textExerciseGroup::Remove exercise"),onRemove:function(){return o.remove(e.index)}}))))})))),a.createElement(D.AddButton,{onClick:function(){return o.insert()}},c.t("textExerciseGroup::Add exercise")),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{content:ve(),cohesive:b.boolean(!1)}),{"grouped-text-exercise":b.list(xe("type-text-exercise"))}),config:{}},_e={Component:function(e){var t=i.useI18n(),n=a.useCallback((function(e){return a.createElement(a.Fragment,null,t.t(e?"solution::Show solution":"solution::Hide solution"))}),[]);return a.createElement(a.Fragment,null,e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),a.createElement(r.ThemeProvider,{theme:je},a.createElement(_.ExpandableBox,{renderTitle:n,editable:e.editable},e.state.content.render())),e.config.skipControls?null:a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Ee(ne({},ge,{content:ve("solution")}),{}),config:{skipControls:!1}},je={rendererUi:{expandableBox:{toggleBackgroundColor:"#d9edf7",containerBorderColor:"#d9edf7"}}},ze={Component:function(e){return a.createElement(a.Fragment,null,e.state.description.render(),a.createElement(he,null))},state:b.object({description:ve()}),config:{}},Me=Ee(ne({},ge,{content:b.string(),title:b.string(),description:ve(),reasoning:ve()}),{}),Be=x.createVideoPlugin(),He={Component:function(e){var t=e.state,n=t.title,r=t.description,l=i.useI18n();return a.createElement("section",null,e.renderIntoToolbar(a.createElement(Ce,{id:e.state.id.value,currentRevision:e.state.revision.value,onSwitchRevision:e.state.replaceOwnState})),a.createElement("div",{className:"page-header"},a.createElement("h1",null,e.editable?a.createElement(fe,{placeholder:l.t("video::Title"),value:n.value,onChange:function(e){n.set(e.target.value)}}):a.createElement("span",{itemProp:"name"},n.value))),a.createElement("article",null,a.createElement("section",null,a.createElement(Be.Component,Object.assign({},e,{state:{src:e.state.content,alt:e.state.title},config:{i18n:{src:{label:l.t("video::URL")},alt:{label:l.t("video::Title for search engines")}}}}))),a.createElement("section",null,r.render())),a.createElement(he,Object.assign({subscriptions:!0},e.state)))},state:Me,config:{}},Ge=r.styled.div((function(e){var t;return(t={position:"relative",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent"})[e.positionAbove?"borderTop":"borderBottom"]="10px solid rgba(51,51,51,0.95)",t})),Ue=r.styled.div({position:"absolute",top:"-10000px",left:"-10000px",opacity:0,transition:"opacity 0.5s",zIndex:95,whiteSpace:"nowrap"}),We=r.styled.div({boxShadow:"0 2px 4px 0 rgba(0,0,0,0.50)",backgroundColor:"rgba(51,51,51,0.95)",color:"#ffffff",borderRadius:"4px","& a":{color:"#ffffff","&:hover":{color:"rgb(70, 155, 255)"}}});function Ve(e){var t=a.createRef(),n=a.createRef(),r=a.useState("above"===e.position),i=r[0],l=r[1];return a.useLayoutEffect((function(){if(t.current&&n.current){var r=t.current,a=void 0;if(e.anchor&&null!==e.anchor.current)a=e.anchor.current.getBoundingClientRect();else{var o=window.getSelection();o&&o.rangeCount>0&&(a=o.getRangeAt(0).getBoundingClientRect())}if(a&&0!==a.height&&r.offsetParent){var c=r.offsetParent.getBoundingClientRect();r.style.opacity="1";var s=a.top-r.offsetHeight-6;l("above"==e.position&&s>=0),r.style.top=(i?s:a.bottom+6)-c.top+"px",r.style.left=Math.min(Math.max(a.left-c.left-r.offsetWidth/2+a.width/2,0),c.width-r.offsetWidth-5)+"px",n.current.style.left=a.left-r.offsetLeft-c.left-n.current.offsetWidth/2+a.width/2+"px"}}}),[t,n,e.position,e.anchor,i,e.allowSelectionOverflow]),a.createElement(Ue,{ref:t},!i&&a.createElement(Ge,{positionAbove:!1,ref:n}),a.createElement(We,null,e.children),i&&a.createElement(Ge,{positionAbove:!0,ref:n}))}var Ye=["position"],Xe=r.styled.span({padding:"0px 8px"}),Je=r.styled.div({padding:"5px 5px 5px 10px",display:"inline-block",borderLeft:"2px solid rgba(51,51,51,0.95)",cursor:"pointer",margin:"2px","&:hover":{color:"rgb(70, 155, 255)"}});function Ke(e){var t=e.position,n=void 0===t?"below":t,i=re(e,Ye);return a.createElement(Ve,{position:n,anchor:i.anchor},a.createElement(Xe,null,i.children),a.createElement(Je,{onClick:i.onDelete},a.createElement(r.Icon,{icon:r.faTrashAlt})))}var Qe=r.styled.input({backgroundColor:"transparent",border:"none",borderBottom:"2px solid #ffffff",color:"#ffffff","&:focus":{outline:"none",borderBottom:"2px solid rgb(70, 155, 255)"}}),$e=function(e,t){return a.createElement(Qe,Object.assign({},e,{ref:t}))},Ze=a.forwardRef($e);function et(e){var t=e.onChange,n=e.value,r=e.placeholder,i=a.useState(z.deserialize(n)),l=i[0],o=i[1];return a.useEffect((function(){z.serialize(l)!==n&&o(z.deserialize(n))}),[n]),a.createElement(M.Editor,{placeholder:r,value:l,onFocus:function(t,n,r){setTimeout((function(){"function"==typeof e.onFocus&&e.onFocus()})),r()},onChange:function(e){var n=e.value;o(n),t(z.serialize(n))}})}var tt,nt=b.object({id:b.string(),title:b.string()}),rt={Component:function(e){var t,n,l,o=e.editable,s=e.state,u=s.introduction,d=s.content,m=s.exercises,p=s.exerciseFolder,g=s.relatedContent,f=s.sources,h=i.useI18n(),E=a.useState(null),v=E[0],x=E[1];function b(e,t){return v&&v.id===e&&(void 0===v.index||v.index===t)}return a.createElement(a.Fragment,null,a.createElement(De,{editable:o},u.render()),a.createElement(De,{editable:o},d.render()),a.createElement(De,{editable:o},function(){var e=a.createElement("h2",null,h.t("article::Exercises")),t=a.createElement("p",null,h.t("article::You can find more exercises in the following folder"),":");return o?a.createElement(a.Fragment,null,e,a.createElement(j.DragDropContext,{onDragEnd:function(e){var t=e.destination;t&&m.move(e.source.index,t.index)}},a.createElement(j.Droppable,{droppableId:"default"},(function(e){return a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),m.map((function(e,t){return a.createElement(j.Draggable,{key:e.id,draggableId:e.id,index:t},(function(n){return a.createElement("div",Object.assign({ref:n.innerRef},n.draggableProps),e.render({renderToolbar:function(){return a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement(at,Object.assign({icon:a.createElement(r.Icon,{icon:r.faTrashAlt}),title:h.t("article::Drag the exercise")},n.dragHandleProps),a.createElement(ot,null,a.createElement(r.EdtrIcon,{icon:r.edtrDragHandle})))),a.createElement(y.PluginToolbarButton,{icon:a.createElement(lt,null,a.createElement(r.Icon,{icon:r.faTrashAlt})),label:h.t("article::Remove exercise"),onClick:function(){m.remove(t)}}))}}))}))})),e.placeholder)}))),a.createElement(D.AddButton,{onClick:function(){m.insert(m.length)}},h.t("article::Add optional exercise")),t,b("exerciseFolder")?a.createElement(Ke,{onDelete:function(){p.title.set(""),p.id.set("")},position:"below"},a.createElement(Ze,{value:""!==p.id.value?"/"+p.id.value:"",placeholder:h.t("article::ID of an exercise folder, e.g. 30560"),onChange:function(e){var t=e.target.value.replace(/[^0-9]/g,"");p.id.set(t)}}),a.createElement("a",{target:"_blank",href:""!==p.id.value?"/"+p.id.value:"",rel:"noopener noreferrer"},a.createElement(it,{title:h.t("article::Open the exercise folder in a new tab:")},a.createElement(r.Icon,{icon:r.faExternalLinkAlt})))):null,a.createElement("a",null,a.createElement(et,{value:p.title.value,onFocus:function(){x({id:"exerciseFolder"})},onChange:function(e){p.title.set(e)},placeholder:h.t("article::Title of the link")}))):0!==m.length&&p.id.value?a.createElement(a.Fragment,null,e,m.map((function(e){return a.createElement(a.Fragment,{key:e.id},e.render())})),p.id.value?a.createElement(a.Fragment,null,t,a.createElement("div",null,a.createElement("a",{href:"/"+p.id.value},p.title.value))):null):null}()),a.createElement(De,{editable:o},(t=a.createElement(a.Fragment,null,a.createElement("h2",null,h.t("article::Still want more?")),a.createElement("p",null,h.t("article::You can find more content on this topic here"),":")),n=[{icon:a.createElement(r.Icon,{icon:U.faNewspaper,fixedWidth:!0}),section:"articles",label:h.t("article::Articles"),addLabel:h.t("article::Add article"),idPlaceholder:h.t("article::ID of an article, e.g. 1855"),openLinkInNewTabPlaceholder:h.t("article::Open the article in a new tab:"),dragLabel:h.t("article::Drag the article")},{icon:a.createElement(r.Icon,{icon:G.faGraduationCap,fixedWidth:!0}),section:"courses",label:h.t("article::Courses"),addLabel:h.t("article::Add course"),idPlaceholder:h.t("article::ID of a course, e.g. 51979"),openLinkInNewTabPlaceholder:h.t("article::Open the course in a new tab:"),dragLabel:h.t("article::Drag the course")},{icon:a.createElement(r.Icon,{icon:W.faPlayCircle,fixedWidth:!0}),section:"videos",label:h.t("article::Videos"),addLabel:h.t("article::Add video"),idPlaceholder:h.t("article::ID of a video, e.g. 40744"),openLinkInNewTabPlaceholder:h.t("article::Open the video in a new tab:"),dragLabel:h.t("article::Drag the video")}],l=c.flatten(c.values(g)),o||0!==l.length?a.createElement(a.Fragment,null,t,n.map((function(e){return a.createElement(a.Fragment,{key:e.section},function(e){var t=a.createElement(a.Fragment,null,e.icon," ",e.label);return o?a.createElement(a.Fragment,null,t,a.createElement(j.DragDropContext,{onDragEnd:function(t){var n=t.destination;n&&g[e.section].move(t.source.index,n.index)}},a.createElement(j.Droppable,{droppableId:"default"},(function(t){return a.createElement("div",Object.assign({ref:t.innerRef},t.droppableProps),g[e.section].map((function(t,n){return a.createElement(j.Draggable,{key:n,draggableId:e.section+"-"+n,index:n},(function(i){return a.createElement("div",Object.assign({ref:i.innerRef},i.draggableProps),a.createElement("div",{style:{display:"flex"}},a.createElement("div",{style:{flexGrow:1}},b(e.section,n)?a.createElement(Ke,{onDelete:function(){g[e.section].remove(n)},position:"below"},a.createElement(Ze,{value:""!==t.id.value?"/"+t.id.value:"",placeholder:e.idPlaceholder,onChange:function(e){var n=e.target.value.replace(/[^0-9]/g,"");t.id.set(n)}}),a.createElement("a",{target:"_blank",href:""!==t.id.value?"/"+t.id.value:"",rel:"noopener noreferrer"},a.createElement(it,{title:e.openLinkInNewTabPlaceholder},a.createElement(r.Icon,{icon:r.faExternalLinkAlt})))):null,a.createElement("a",null,a.createElement(et,{value:t.title.value,onFocus:function(){x({id:e.section,index:n})},onChange:function(e){t.title.set(e)},placeholder:h.t("article::Title of the link")}))),a.createElement("div",null,a.createElement(at,Object.assign({icon:a.createElement(r.Icon,{icon:r.faTrashAlt}),title:h.t("article::Drag the exercise")},i.dragHandleProps),a.createElement(ot,null,a.createElement(r.EdtrIcon,{icon:r.edtrDragHandle}))))))}))})),t.placeholder,o?a.createElement(D.AddButton,{onClick:function(){g[e.section].insert(g[e.section].length)}},e.addLabel):null)})))):0===g[e.section].length?null:a.createElement(a.Fragment,null,t,g[e.section].map((function(e,t){return a.createElement("div",{key:t},a.createElement("a",{href:"/"+e.id.value},e.title.value))})))}(e))}))):null)),a.createElement(De,{editable:o},o?a.createElement(B.ThemeProvider,{theme:ct},a.createElement(_.ExpandableBox,{renderTitle:function(){return h.t("article::Sources")},editable:o,alwaysVisible:!0},a.createElement(j.DragDropContext,{onDragEnd:function(e){var t=e.destination;t&&f.move(e.source.index,t.index)}},a.createElement(j.Droppable,{droppableId:"default"},(function(e){return a.createElement("ul",Object.assign({ref:e.innerRef},e.droppableProps),f.map((function(e,t){return a.createElement(j.Draggable,{key:t,draggableId:""+t,index:t},(function(n){return a.createElement("li",Object.assign({ref:n.innerRef},n.draggableProps),a.createElement("div",{style:{display:"flex"}},a.createElement("div",{style:{flexGrow:1}},a.createElement("span",null,b("source",t)?a.createElement(Ke,{onDelete:function(){f.remove(t)},position:"below"},a.createElement(Ze,{value:e.href.value,placeholder:h.t("article::URL of the link"),onChange:function(t){e.href.set(t.target.value)}}),a.createElement("a",{target:"_blank",href:e.href.value,rel:"noopener noreferrer"},a.createElement(it,{title:h.t("article::Open the link in a new tab:")},a.createElement(r.Icon,{icon:r.faExternalLinkAlt})))):null,a.createElement("a",null,a.createElement(et,{value:e.title.value,onFocus:function(){x({id:"source",index:t})},onChange:function(t){e.title.set(t)},placeholder:h.t("article::Title of the link")})))),a.createElement("div",null,a.createElement(at,Object.assign({icon:a.createElement(r.Icon,{icon:r.faTrashAlt}),title:h.t("article::Drag the source")},n.dragHandleProps),a.createElement(ot,null,a.createElement(r.EdtrIcon,{icon:r.edtrDragHandle}))))))}))})),e.placeholder)}))),o?a.createElement(D.AddButton,{onClick:function(){f.insert(f.length)}},h.t("article::Add source")):null)):0===f.length?null:a.createElement(B.ThemeProvider,{theme:ct},a.createElement(_.ExpandableBox,{renderTitle:function(){return h.t("article::Sources")},editable:o,alwaysVisible:!0},a.createElement("ul",null,f.map((function(e,t){return a.createElement("li",{key:t},a.createElement("a",{href:e.href.value},e.title.value))})))))))},state:b.object({introduction:b.child({plugin:"articleIntroduction"}),content:b.child({plugin:"rows"}),exercises:b.list(b.child({plugin:"injection"})),exerciseFolder:nt,relatedContent:b.object({articles:b.list(nt),courses:b.list(nt),videos:b.list(nt)}),sources:b.list(b.object({href:b.string(),title:b.string()}))}),config:{}},it=r.styled.span({margin:"0 0 0 10px"}),at=r.styled.button({background:"none",border:"none"}),lt=r.styled.div({width:"24px"}),ot=r.styled.div({height:"24px",width:"24px",opacity:.8,cursor:"pointer",color:"rgba(51, 51, 51, 0.95)","&:hover":{color:"#469bff"}}),ct={rendererUi:{expandableBox:{toggleBackgroundColor:"#f5f5f5",toggleColor:"#333",containerBorderColor:"#f5f5f5"}}},st={Component:function(e){var t=i.useI18n();return a.createElement("div",{className:"panel panel-danger"},a.createElement("div",{className:"panel-heading"},t.t("error::This part of the document could not be converted.")),a.createElement("div",{className:"panel-body"},a.createElement("pre",null,JSON.stringify({plugin:e.state.plugin.value,state:e.state.state.value},void 0,2))))},state:b.object({plugin:b.string(),state:b.scalar({})}),config:{}};function ut(e){switch(e){case tt.Equals:return"=";case tt.GreaterThan:return">";case tt.GreaterThanOrEqual:return"≥";case tt.LessThan:return"<";case tt.LessThanOrEqual:return"≤";case tt.AlmostEqualTo:return"≈";case tt.Estimates:return"≙"}}!function(e){e.Equals="equals",e.GreaterThan="greater-than",e.GreaterThanOrEqual="greater-than-or-equal",e.LessThan="less-than",e.LessThanOrEqual="less-than-or-equal",e.AlmostEqualTo="almost-equal-to",e.Estimates="estimates"}(tt||(tt={}));var dt,mt=r.styled.div({overflowX:"scroll",padding:"10px 0"}),pt=r.styled.table({whiteSpace:"nowrap"}),gt=r.styled.td({verticalAlign:"baseline"}),ft=r.styled(gt)({textAlign:"right"}),ht=r.styled.td({padding:"0 3px",textAlign:"center",verticalAlign:"baseline"}),Et=r.styled(gt)({paddingLeft:"5px"}),vt=r.styled.tr({color:"#007ec1",div:{margin:0}});function xt(e){var t=e.state,n=y.useScopedStore();return a.createElement(mt,null,a.createElement(pt,null,a.createElement("tbody",null,function(){if(!w.isEmpty(t.firstExplanation.id)(n.getState()))return a.createElement(a.Fragment,null,a.createElement(vt,null,a.createElement("td",{colSpan:3,style:{textAlign:"center"}},t.firstExplanation.render())),a.createElement("tr",{style:{height:"30px"}},a.createElement("td",null),bt()))}(),t.steps.map((function(e,t){return a.createElement(a.Fragment,{key:t},a.createElement("tr",null,a.createElement(ft,null,e.left.value?a.createElement(V.MathRenderer,{inline:!0,state:e.left.value}):null),a.createElement(ht,null,a.createElement(V.MathRenderer,{inline:!0,state:ut(e.sign.value)})),a.createElement(gt,null,e.right.value?a.createElement(V.MathRenderer,{inline:!0,state:e.right.value}):null),a.createElement(Et,null,e.transform.value?a.createElement(a.Fragment,null,"|",a.createElement(V.MathRenderer,{inline:!0,state:e.transform.value})):null)),w.isEmpty(e.explanation.id)(n.getState())?null:a.createElement(vt,null,a.createElement("td",null),bt(),a.createElement("td",{colSpan:2},e.explanation.render())))})))))}function bt(){var e=Buffer.from('\n    <svg xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <marker\n          id="arrow"\n          markerWidth="10"\n          markerHeight="10"\n          orient="auto"\n          markerUnits="strokeWidth"\n          refX="10"\n          refY="5"\n          viewBox="0 0 20 10"\n        >\n          <path\n            d="M 0,0 l 10,5 l -10,5"\n            stroke="#007ec1"\n            stroke-width="2"\n            fill="none"\n            vector-effect="non-scaling-size"\n          />\n        </marker>\n      </defs>\n\n      <line\n        x1="10"\n        y1="0%"\n        x2="10"\n        y2="99%"\n        stroke="#007ec1"\n        stroke-width="2"\n        marker-end="url(#arrow)"\n        vector-effect="non-scaling-stroke"\n      />\n    </svg>').toString("base64");return a.createElement("td",{style:{backgroundImage:"url('data:image/svg+xml;base64,"+e+"')",backgroundSize:"20px calc(100% - 10px)",backgroundRepeat:"no-repeat",backgroundPosition:"center 5px"}})}!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Transform=2]="Transform",e[e.Explanation=3]="Explanation"}(dt||(dt={})),t.setDefaultPreference("katex:usevisualmath",!0);var yt=r.styled.button({outline:"none",width:"35px",border:"none",background:"transparent"}),wt=r.styled.span({cursor:"grab",paddingRight:"5px"}),Ct=r.styled.select({height:"30px",width:"35px",marginLeft:"15px",marginRight:"10px",backgroundColor:"lightgrey",border:"1px solid lightgrey",borderRadius:"5px"});function St(e){var t=i.useI18n(),n=e.gridFocus,r=e.row,l=e.state;return a.createElement(a.Fragment,null,a.createElement(ft,{onClick:function(){return n.setFocus({row:r,column:dt.Left})}},a.createElement(It,{focused:n.isFocused({row:r,column:dt.Left}),placeholder:0===r?"3x+1":"["+t.t("equations::left-hand side")+"]",state:l.left,onChange:function(e){return l.left.set(e)},onFocusNext:function(){return n.moveRight()},onFocusPrevious:function(){return n.moveLeft()}})),a.createElement(ht,null,a.createElement(Ct,{tabIndex:-1,onChange:function(e){l.sign.set(e.target.value)},value:l.sign.value},[tt.Equals,tt.GreaterThan,tt.LessThan,tt.GreaterThanOrEqual,tt.LessThanOrEqual,tt.AlmostEqualTo,tt.Estimates].map((function(e){return a.createElement("option",{key:e,value:e},ut(e))})))),a.createElement(gt,{onClick:function(){return n.setFocus({row:r,column:dt.Right})}},a.createElement(It,{focused:n.isFocused({row:r,column:dt.Right}),placeholder:0===r?"7x":"["+t.t("equations::right-hand side")+"]",state:l.right,onChange:function(e){return l.right.set(e)},onFocusNext:function(){return n.moveRight()},onFocusPrevious:function(){return n.moveLeft()}})),a.createElement(Et,{onClick:function(){return n.setFocus({row:r,column:dt.Transform})}},"|"," ",a.createElement(It,{focused:n.isFocused({row:r,column:dt.Transform}),placeholder:0===r?"-3x":"["+t.t("equations::transformation")+"]",state:l.transform,onChange:function(e){return l.transform.set(e)},onFocusNext:function(){return n.moveRight()},onFocusPrevious:function(){return n.moveLeft()}})))}function It(e){var n=e.focused,r=e.onFocusNext,i=e.onFocusPrevious,l=e.onChange,o=e.state,c=e.prefix,s=void 0===c?"":c,u=e.suffix,d=void 0===u?"":u,m=a.useContext(t.PreferenceContext);return a.createElement(V.MathEditor,{readOnly:!n,state:""+s+o.value+d,config:{i18n:{placeholder:e.placeholder}},inline:!0,disableBlock:!0,visual:!0===m.getKey("katex:usevisualmath"),onEditorChange:function(e){m.setKey("katex:usevisualmath",e)},onInlineChange:function(){},onChange:l,onMoveOutRight:r,onMoveOutLeft:i})}var kt={Component:function(e){var t,n,l,o,s,u,d,m,p,g,f=i.useI18n(),h=e.focused,E=e.state,v=y.useScopedStore(),x=y.useScopedSelector(w.getFocused()),b=h||c.includes(x,e.state.steps.map((function(e){return e.explanation.id})))||x===E.firstExplanation.id,C=(n=(t={rows:E.steps.length,columns:4,focusNext:function(){return v.dispatch(w.focusNext())},focusPrevious:function(){return v.dispatch(w.focusPrevious())},onFocusChanged:function(t){v.dispatch(w.focus("firstExplanation"===t?e.state.firstExplanation.id:t.column===dt.Explanation?e.state.steps[t.row].explanation.id:e.id))}}).rows,l=t.columns,o=t.focusNext,s=t.focusPrevious,u=t.onFocusChanged,d=a.useState(null),p=d[1],{focus:m=d[0],isFocused:function(e){return null!==m&&("firstExplanation"===m?e===m:"firstExplanation"!==e&&m.row===e.row&&m.column===e.column)},setFocus:g=function(e){u(e),p(e)},moveRight:function(){null!==m&&("firstExplanation"!==m?m.column===l-1?m.row===n-1?o():g({row:m.row+1,column:0}):g({row:m.row,column:m.column+1}):g({row:0,column:0}))},moveLeft:function(){null!==m&&("firstExplanation"!==m?g(0===m.column?0===m.row?"firstExplanation":{row:m.row-1,column:l-1}:{row:m.row,column:m.column-1}):s())}});return a.useEffect((function(){b&&(C.setFocus({row:0,column:0}),v.dispatch(w.focus(e.id)))}),[b]),b?a.createElement(y.HotKeys,{allowChanges:!0,keyMap:{FOCUS_NEXT_OR_INSERT:"tab",FOCUS_PREVIOUS:"shift+tab",INSERT:"return"},handlers:{FOCUS_NEXT_OR_INSERT:function(e){S(e,(function(){if(C.isFocused({row:E.steps.length-1,column:dt.Transform})){var e=E.steps.length;I(e),C.setFocus({row:e-1,column:dt.Explanation})}else C.moveRight()}))},FOCUS_PREVIOUS:function(e){S(e,(function(){return C.moveLeft()}))},INSERT:function(e){S(e,(function(){C.focus&&"firstExplanation"!==C.focus&&k(C.focus.row+1)}))}}},a.createElement(mt,null,a.createElement(j.DragDropContext,{onDragEnd:function(e){var t=e.destination;t&&E.steps.move(e.source.index,t.index)}},a.createElement(j.Droppable,{droppableId:"default"},(function(e){return a.createElement(pt,Object.assign({ref:e.innerRef},e.droppableProps),a.createElement("tbody",{onFocus:function(){return C.setFocus("firstExplanation")}},a.createElement(vt,null,a.createElement("td",null),a.createElement("td",{colSpan:3,style:{textAlign:"center"}},E.firstExplanation.render({config:{placeholder:f.t("equations::frist-explanation")}}))),a.createElement("tr",{style:{height:"30px"}},a.createElement("td",null),a.createElement("td",null),w.isEmpty(E.firstExplanation.id)(v.getState())?null:bt())),E.steps.map((function(e,t){return a.createElement(j.Draggable,{key:e.explanation.id,draggableId:e.explanation.id,index:t},(function(n){return a.createElement("tbody",Object.assign({ref:n.innerRef},n.draggableProps),a.createElement("tr",null,a.createElement("td",null,a.createElement(wt,Object.assign({},n.dragHandleProps,{tabIndex:-1}),a.createElement(r.EdtrIcon,{icon:r.edtrDragHandle}))),a.createElement(St,{gridFocus:C,row:t,state:e}),a.createElement("td",null,a.createElement(yt,{tabIndex:-1,onClick:function(){return E.steps.remove(t)}},a.createElement(r.Icon,{icon:r.faTimes})))),t===E.steps.length-1?null:a.createElement(vt,{onFocus:function(){return C.setFocus({row:t,column:dt.Explanation})}},a.createElement("td",null),a.createElement("td",null),w.isEmpty(e.explanation.id)(v.getState())?a.createElement("td",null):bt(),a.createElement("td",{colSpan:2},e.explanation.render({config:{placeholder:f.t("equations::explanation")}}))))}))})),e.placeholder)}))),function(){if(b)return a.createElement(D.AddButton,{onClick:function(){return k(E.steps.length)}},f.t("equations::add new equation"))}())):a.createElement(xt,Object.assign({},e));function S(e,t){e&&e.preventDefault(),t()}function I(e){E.steps.insert(e,{left:"",sign:E.steps[e-1].sign.value,right:"",transform:"",explanation:{plugin:"text"}})}function k(e){I(e),C.setFocus({row:e,column:dt.Left})}},config:{},state:b.object({steps:b.list(b.object({left:b.string(""),sign:b.string(tt.Equals),right:b.string(""),transform:b.string(""),explanation:b.child({plugin:"text"})}),2),firstExplanation:b.child({plugin:"text"})})},Tt={Component:function(e){var t=e.editable,n=e.state,l=i.useI18n(),o=y.useScopedStore(),c=n.content,s=n.interactive,u=a.useState(!1),d=u[0],m=u[1];return a.createElement(a.Fragment,null,a.createElement(De,{editable:t},c.render()),a.createElement(De,{editable:t},s.defined?s.render({renderToolbar:function(e){return a.createElement(a.Fragment,null,a.createElement("div",{style:{position:"relative"},onMouseLeave:function(){m(!1)}},a.createElement(y.PluginToolbarButton,{icon:a.createElement(r.Icon,{icon:r.faRandom}),label:"Interaktives Element ändern",onClick:function(){m(!0)}}),a.createElement(y.PluginToolbarButton,{icon:a.createElement(r.Icon,{icon:r.faTrashAlt}),label:"Interaktives Element entfernen",onClick:function(){s.remove()}}),d?a.createElement(Lt,null,Ft.filter((function(e){return!s||e.name!==function(){if(!s.defined)return null;var e=w.getDocument(s.id)(o.getState());return e&&e.plugin}()})).map((function(e){return a.createElement(Nt,{key:e.name,onClick:function(){s.replace(e.name),m(!1)}},e.title(l))}))):null),e)}}):t?a.createElement(a.Fragment,null,a.createElement("p",null,a.createElement("em",null,l.t("exercise::Add an optional interactive exercise:"))),a.createElement(Ot,null,Ft.map((function(e){return a.createElement(D.AddButton,{key:e.name,onClick:function(){s.create({plugin:e.name})}},e.addLabel(l))})))):null))},state:b.object({content:b.child({plugin:"rows"}),interactive:b.optional(b.child({plugin:"scMcExercise"}))}),config:{}},Ot=Y.styled.div({display:"flex"}),Ft=[{name:"scMcExercise",addLabel:function(e){return e.t("exercise::Add choice exercise")},title:function(e){return e.t("exercise::Choice exercise")}},{name:"inputExercise",addLabel:function(e){return e.t("exercise::Add input exercise")},title:function(e){return e.t("exercise::Input exercise")}}],Rt=Y.styled.div({position:"absolute",top:"-30px",right:"0",padding:"30px",zIndex:95,whiteSpace:"nowrap"}),qt=Y.styled.div({boxShadow:"0 2px 4px 0 rgba(0,0,0,0.50)",backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"4px"});function Lt(e){return a.createElement(Rt,null,a.createElement(qt,null,e.children))}var Pt,Nt=Y.styled.div({padding:"5px 10px",cursor:"pointer",width:"100%",minWidth:"150px","&:hover":{color:"rgb(70, 155, 255)"}}),Dt=["gif","jpg","jpeg","png","svg"];function At(e){switch(e){case Pt.TOO_MANY_FILES:return"You can only upload one file";case Pt.NO_FILE_SELECTED:return"No file selected";case Pt.BAD_EXTENSION:return"Not an accepted file type";case Pt.FILE_TOO_BIG:return"Filesize is too big";case Pt.UPLOAD_FAILED:return"Error while uploading"}}!function(e){e[e.TOO_MANY_FILES=0]="TOO_MANY_FILES",e[e.NO_FILE_SELECTED=1]="NO_FILE_SELECTED",e[e.BAD_EXTENSION=2]="BAD_EXTENSION",e[e.FILE_TOO_BIG=3]="FILE_TOO_BIG",e[e.UPLOAD_FAILED=4]="UPLOAD_FAILED"}(Pt||(Pt={}));var _t=function(e){var t,n,r,i=[];if(e)if(n=(t=e.name).toLowerCase().slice(t.lastIndexOf(".")+1),Dt.indexOf(n)>=0){if(!(e.size>2097152))return{valid:!0};i=[].concat(i,[Pt.FILE_TOO_BIG])}else i=[].concat(i,[Pt.BAD_EXTENSION]);else i=[].concat(i,[Pt.NO_FILE_SELECTED]);return{valid:!1,errors:(r=i,r.map((function(e){return{errorCode:e,message:At(e)}})))}};function jt(e){var t=function(e){return function(t){return new Promise((function(n,r){var i=new FileReader;i.onload=function(i){if(i.target){var a=new FormData;a.append("attachment[file]",t),a.append("type","file"),a.append("csrf",e()),N("/attachment/upload",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){e.success||r(),n({file:t,dataUrl:e.files[0].location})})).catch((function(){r()}))}},i.readAsDataURL(t)}))}}(e);return function(e){var n=_t(e);return n.valid?t(e).then((function(e){return e.dataUrl})):(alert(n.errors.map((function(e){return e.message})).join("\n")),Promise.reject(n.errors))}}function zt(e){return X.createImagePlugin({upload:jt(e),validate:_t,secondInput:"description"})}var Mt=b.child({plugin:"text"}),Bt=_.styled.div({borderLeft:"#bedfed solid 5px",paddingLeft:"15px"});function Ht(e){return a.createElement(Bt,null,e.state.render())}var Gt={Component:function(e){var t=a.useState(e.state.value),n=t[0],l=t[1],o=a.useState(!1),c=o[0],s=o[1],u=i.useI18n();return a.useEffect((function(){var t=setTimeout((function(){l(e.state.value)}),2e3);return function(){clearTimeout(t)}}),[e.focused,e.state.value]),e.editable?a.createElement(a.Fragment,null,n?a.createElement(D.PreviewOverlay,{focused:e.focused||!1,onChange:function(t){s(t),t&&l(e.state.value)}},a.createElement(Ut,{src:n})):a.createElement(Vt,null,a.createElement(r.Icon,{icon:r.faNewspaper,size:"5x"})),e.focused&&!c?a.createElement(Y.EditorInlineSettings,null,a.createElement(Y.EditorInput,{label:u.t("injection::Serlo ID:"),placeholder:"123456",value:e.state.value,onChange:function(t){e.state.set(t.target.value)},width:"30%",inputWidth:"100%",ref:e.autofocusRef})):null,e.renderIntoSettings(a.createElement(a.Fragment,null,a.createElement(y.OverlayInput,{label:u.t("injection::Serlo ID:"),placeholder:"123456",value:e.state.value,onChange:function(t){e.state.set(t.target.value)}})))):a.createElement(Ut,{src:e.state.value})},state:b.string(),config:{}};function Ut(e){var t=a.useState(""),n=t[0],r=t[1],l=a.useRef(null),o=i.useI18n();if(a.useEffect((function(){var t=Wt(e.src);N(t,{headers:{"X-Requested-With":"XMLHttpRequest","X-From":"legacy-serlo.org"}}).then((function(e){return e.json()})).then((function(e){r(e.response),setTimeout((function(){l.current&&Common.trigger("new context",l.current)}))})).catch((function(){r('<div class="alert alert-info">'+o.t("injection::Illegal injection found")+"</div>")}))}),[e.src]),n)return a.createElement("div",{className:"panel panel-default"},a.createElement("div",{className:"panel-body",ref:l,dangerouslySetInnerHTML:{__html:n}}));var c=Wt(e.src);return a.createElement("div",null,a.createElement("a",{href:c},o.t("injection::Serlo entity {{src}}",{src:c})))}function Wt(e){if(e.startsWith("/")||e.startsWith("\\"))return"/"+e.substring(1,e.length);var t=e.match(/^https?:\/\/[^./]+\.serlo\.[^./]+\/(.+)$/g);return t?"/"+t[1]:"/"+e}var Vt=Y.styled.div({position:"relative",width:"100%",textAlign:"center"}),Yt=_.styled.div({display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"flex-start"}),Xt=_.styled.div((function(e){return{width:e.width/12*100+"%","@media (max-width: 480px)":{width:"100%"}}})),Jt=_.styled.div({padding:"5px",backgroundColor:"#f2dede",color:"#a94442",border:"1px solid #ebccd1",textAlign:"center"}),Kt=_.styled.div({display:"flex",flexDirection:"row"}),Qt=_.styled.button({borderRadius:"5px",margin:"5px",border:"none",outline:"none",backgroundColor:"white","&:hover":{backgroundColor:"#ebccd1"}}),$t={Component:function(e){var t=y.useScopedStore(),n=i.useI18n();return a.createElement(a.Fragment,null,e.editable?a.createElement(Jt,null,n.t("layout::To make the content draggable, convert them for the new editor:"),a.createElement(Kt,null,a.createElement(Qt,{onClick:function(){var n=[];e.state.forEach((function(e){var r=w.serializeDocument(e.child.id)(t.getState());r&&("rows"===r.plugin?r.state.forEach((function(e){n.push(e)})):n.push(r))})),t.dispatch(w.replace({id:e.id,plugin:"rows",state:n}))}},n.t("layout::One-column layout")),r()?a.createElement(Qt,{onClick:function(){if(r()){var n=e.state;l(n[0])?i({explanationColumn:n[1],multimediaColumn:n[0]}):i({explanationColumn:n[0],multimediaColumn:n[1]})}function i(n){var r=n.multimediaColumn,i=w.serializeDocument(n.explanationColumn.child.id)(t.getState()),a=w.serializeDocument(r.child.id)(t.getState());i&&a&&t.dispatch(w.replace({id:e.id,plugin:"multimedia",state:{explanation:i,multimedia:a.state[0],illustrating:!0,width:50}}))}}},n.t("layout::Multimedia content associated with text")):null)):null,a.createElement(Yt,null,e.state.map((function(e,t){return a.createElement(Xt,{key:t,width:e.width.value},e.child.render())}))));function r(){var t=e.state;return 2===t.length&&(l(t[0])||l(t[1]))}function l(e){var n=w.serializeDocument(e.child.id)(t.getState());if(!n)return!1;var r=n.state.map((function(e){return e.plugin}));return 1===r.length&&function(e){return"image"===e||"geogebra"===e||"video"===e}(r[0])}},state:b.list(b.object({child:b.child({plugin:"text"}),width:b.number()})),config:{}},Zt={Component:function(e){return e.editable?a.createElement(en,null,a.createElement(tn,null)):null},state:b.scalar(void 0),config:{}},en=H.div({paddingTop:"10px",paddingBottom:"10px"}),tn=H.hr({marginTop:0,marginBottom:0}),nn={Component:function(e){var t=e.editable,n=e.state,l=e.focused,o=n.prerequisite,c=n.strategy,s=i.useI18n(),u=!y.useScopedSelector(w.isEmpty(c.id));return a.createElement(a.Fragment,null,a.createElement(De,{editable:t},t?a.createElement("div",null,s.t("solution::For this exercise, you need the following fundamentals:")," ",l?a.createElement(Ke,{onDelete:function(){o.defined&&o.remove()},position:"below"},a.createElement(Ze,{value:o.defined&&""!==o.id.value?"/"+o.id.value:"",placeholder:s.t("solution::ID of an article, e.g. 1855"),onChange:function(e){var t=e.target.value.replace(/[^0-9]/g,"");o.defined?o.id.set(t):o.create({id:t,title:""})}}),a.createElement("a",{target:"_blank",href:o.defined&&""!==o.id.value?"/"+o.id.value:"",rel:"noopener noreferrer"},a.createElement(rn,{title:s.t("solution::Open the article in a new tab:")},a.createElement(r.Icon,{icon:r.faExternalLinkAlt})))):null,a.createElement("a",null,a.createElement(et,{value:o.defined?o.title.value:"",onChange:function(e){o.defined?o.title.set(e):o.create({id:"",title:e})},placeholder:s.t("solution::Title of the link")}))):o.defined&&o.id.value&&o.title.value?a.createElement("p",null,s.t("solution::For this exercise, you need the following fundamentals:")," ",a.createElement("a",{href:"/"+o.id.value},o.title.value)):null),u||t?a.createElement(De,{editable:t},c.render({config:{placeholder:s.t("solution::Optionally explain the solution strategy here")}})):null,a.createElement(De,{editable:t},n.steps.render()))},state:b.object({prerequisite:b.optional(b.object({id:b.string(),title:b.string()})),strategy:b.child({plugin:"text"}),steps:b.child({plugin:"rows"})}),config:{}},rn=r.styled.span({margin:"0 0 0 10px"}),an=J.createTablePlugin({MarkdownRenderer:function(e){var t=K.converter.makeHtml(e.markdown);return a.createElement("div",{className:"requires-mathjax",dangerouslySetInnerHTML:{__html:t}})}}),ln=ne({},an,{Component:function(e){var t=a.useRef(null);return a.useEffect((function(){Q.initMathJax();var e=setTimeout(n,1e3);return function(){e&&clearTimeout(e)}})),a.createElement("div",{ref:t},a.createElement(an.Component,Object.assign({},e)));function n(){t.current&&Q.typeset(t.current)}}}),on={Component:function(e){var t=i.useI18n();return a.createElement("div",{className:"panel panel-danger"},a.createElement("div",{className:"panel-heading"},t.t("deprecated::This part of the document contains features that are no longer supported.")),a.createElement("div",{className:"panel-body"},a.createElement("pre",null,JSON.stringify({plugin:e.state.plugin.value,state:e.state.state.value},void 0,2))))},state:b.object({plugin:b.string(),state:b.scalar({})}),config:{}};function cn(e){var t,n=e.getCsrfToken,r=e.i18n,i=e.registry;return{anchor:u.createAnchorPlugin({i18n:{label:r.t("anchor::Identifier"),placeholder:r.t("anchor::ID of the anchor")}}),article:rt,articleIntroduction:f.createMultimediaExplanationPlugin({explanation:{plugin:"text",config:{placeholder:r.t("article::Write a short introduction")}},plugins:[{name:"image",title:r.t("multimedia::Image")}],i18n:{changeMultimediaType:r.t("multimedia::Change the multimedia type"),illustrating:{label:r.t("multimedia::How important is the multimedia content?"),values:{illustrating:r.t("multimedia::It is illustrating"),explaining:r.t("multimedia::It is essential")}}}}),blockquote:d.createBlockquotePlugin({content:{plugin:"text"}}),error:st,deprecated:on,equations:kt,exercise:Tt,geogebra:m.createGeogebraPlugin({i18n:{label:r.t("geogebra::GeoGebra URL or ID")}}),highlight:p.createHighlightPlugin({i18n:{code:{label:r.t("highlight::Click here and enter your source code…"),placeholder:r.t("highlight::Enter your source code here")},language:{label:r.t("highlight::Language"),placeholder:r.t("highlight::Enter language")},showLineNumbers:{label:r.t("highlight::Show line numbers")}}}),image:zt(n),important:{Component:Ht,config:{},state:Mt},injection:Gt,inputExercise:g.createInputExercisePlugin({feedback:{plugin:"text"},i18n:{types:(t={},t[g.InputExerciseType.InputStringNormalizedMatchChallenge]=r.t("inputExercise::Text"),t[g.InputExerciseType.InputNumberExactMatchChallenge]=r.t("inputExercise::Number"),t[g.InputExerciseType.InputExpressionEqualMatchChallenge]=r.t("inputExercise::Mathematical expression"),t),type:{label:r.t("inputExercise::Choose the exercise type")},unit:{label:r.t("inputExercise::Unit")},answer:{addLabel:r.t("inputExercise::Add answer"),value:{placeholder:r.t("inputExercise::Enter the value")}},inputPlaceholder:r.t("inputExercise::Your solution"),fallbackFeedback:{correct:r.t("inputExercise::Correct"),wrong:r.t("inputExercise::Wrong")}}}),layout:$t,multimedia:f.createMultimediaExplanationPlugin({explanation:{plugin:"rows"},plugins:[{name:"image",title:r.t("multimedia::Image")},{name:"video",title:r.t("multimedia::Video")},{name:"geogebra",title:r.t("multimedia::GeoGebra Applet")}],i18n:{changeMultimediaType:r.t("multimedia::Change the multimedia type"),illustrating:{label:r.t("multimedia::How important is the multimedia content?"),values:{illustrating:r.t("multimedia::It is illustrating"),explaining:r.t("multimedia::It is essential")}}}}),rows:h.createRowsPlugin({content:{plugin:"text"},plugins:i,i18n:{menu:{searchPlaceholder:r.t("rows::Search for tools…")},settings:{duplicateLabel:r.t("rows::Duplicate"),removeLabel:r.t("rows::Remove"),closeLabel:r.t("rows::Close")},toolbar:{dragLabel:r.t("rows::Drag the element within the document")},addLabel:r.t("rows::Add an element")}}),scMcExercise:E.createScMcExercisePlugin({content:{plugin:"text"},feedback:{plugin:"text"},i18n:{types:{singleChoice:r.t("scMcExercise::Single-choice"),multipleChoice:r.t("scMcExercise::Multiple-choice")},isSingleChoice:{label:r.t("scMcExercise::Choose the exercise type")},answer:{addLabel:r.t("scMcExercise::Add answer"),fallbackFeedback:{wrong:r.t("scMcExercise::Wrong")}},globalFeedback:{missingCorrectAnswers:r.t("scMcExercise::Almost! You missed at least one correct answer"),correct:r.t("scMcExercise::Correct"),wrong:r.t("scMcExercise::Wrong")}}}),separator:Zt,solution:nn,spoiler:v.createSpoilerPlugin({content:{plugin:"rows"},i18n:{title:{placeholder:r.t("spoiler::Enter a title")}}}),table:ln,text:s.createTextPlugin({registry:i,blockquote:"blockquote",i18n:{blockquote:{toggleTitle:r.t("text::Quote")},colors:{setColorTitle:r.t("text::Set color"),resetColorTitle:r.t("text::Reset color"),openMenuTitle:r.t("text::Colors"),closeMenuTitle:r.t("text::Close sub menu")},headings:{setHeadingTitle:function(e){return r.t("text::Heading")+" "+e},openMenuTitle:r.t("text::Headings"),closeMenuTitle:r.t("text::Close sub menu")},link:{toggleTitle:r.t("text::Link (Strg + K)"),placeholder:r.t("text::Enter URL"),openInNewTabTitle:r.t("text::Open in new tab")},list:{toggleOrderedList:r.t("text::Ordered list"),toggleUnorderedList:r.t("text::Unordered list"),openMenuTitle:r.t("text::Lists"),closeMenuTitle:r.t("text::Close sub menu")},math:{toggleTitle:r.t("text::Math formula (Strg + M)"),displayBlockLabel:r.t("text::Display as block"),placeholder:r.t("text::[formula]"),editors:{visual:r.t("text::visual"),latex:r.t("text::LaTeX"),noVisualEditorAvailableMessage:r.t("text::Only LaTeX editor available")},helpText:function(e){return a.createElement(a.Fragment,null,r.t("text::Shortcuts"),":",a.createElement("br",null),a.createElement("br",null),a.createElement("p",null,r.t("text::Fraction"),": ",a.createElement(e,null,"/")),a.createElement("p",null,r.t("text::Superscript"),": ",a.createElement(e,null,"↑")," ",r.t("text::or")," ",a.createElement(e,null,"^")),a.createElement("p",null,r.t("text::Subscript"),": ",a.createElement(e,null,"↓")," ",r.t("text::or")," ",a.createElement(e,null,"_")),a.createElement("p",null,"π, α, β, γ: ",a.createElement(e,null,"pi"),", ",a.createElement(e,null,"alpha"),","," ",a.createElement(e,null,"beta"),",",a.createElement(e,null,"gamma")),a.createElement("p",null,"≤, ≥: ",a.createElement(e,null,"<="),", ",a.createElement(e,null,">=")),a.createElement("p",null,r.t("text::Root"),": ",a.createElement(e,null,"\\sqrt"),","," ",a.createElement(e,null,"\\nthroot")),a.createElement("p",null,r.t("text::Math symbols"),":"," ",a.createElement(e,null,"\\<NAME>"),", ",r.t("text::e.g.")," ",a.createElement(e,null,"\\neq")," (≠), ",a.createElement(e,null,"\\pm")," (±), ..."),a.createElement("p",null,r.t("text::Functions"),": ",a.createElement(e,null,"sin"),","," ",a.createElement(e,null,"cos"),", ",a.createElement(e,null,"ln"),", ..."))}},richText:{toggleStrongTitle:r.t("text::Bold (Strg + B)"),toggleEmphasizeTitle:r.t("text::Italic (Strg + I)")},suggestions:{noResultsMessage:r.t("text::No items found")}}}),video:x.createVideoPlugin({i18n:{src:{label:r.t("video::Video URL")},alt:{label:r.t("video::Description")}}}),"type-applet":Ie,"type-article":ke,"type-course":Te,"type-course-page":Oe,"type-event":Fe,"type-math-puzzle":Re,"type-page":qe,"type-taxonomy":Le,"type-text-exercise":Pe,"type-text-exercise-group":Ae,"type-text-solution":_e,"type-user":ze,"type-video":He}}var sn=a.createContext({onSave:function(){return Promise.reject()},mayCheckout:!1});function un(e){var t=localStorage.getItem("edtr"),n=t?JSON.parse(t):{};n[window.location.pathname]=e,localStorage.setItem("edtr",JSON.stringify(n))}exports.Editor=function(e){var l,o=i.useI18n(),c=le(e),s=cn({getCsrfToken:e.getCsrfToken,registry:(l=["grouped-text-exercise","text-exercise","text-exercise-group"].includes(e.type),[{name:"text",title:o.t("edtr-io::Text"),description:o.t("edtr-io::Compose content using rich text and math formulas."),icon:r.createIcon(r.faParagraph)},{name:"blockquote",title:o.t("edtr-io::Quotation"),description:o.t("edtr-io::Create indented text for quotations."),icon:r.createIcon(r.faQuoteRight)},{name:"geogebra",title:o.t("edtr-io::GeoGebra Applet"),description:o.t("edtr-io::Embed GeoGebra Materials applets via URL or ID."),icon:r.createIcon(r.faCubes)},{name:"highlight",title:o.t("edtr-io::Source Code"),description:o.t("edtr-io::Highlight the syntax of source code."),icon:r.createIcon(r.faCode)},{name:"anchor",title:o.t("edtr-io::Anchor"),description:o.t("edtr-io::Insert an anchor."),icon:r.createIcon(r.faAnchor)},{name:"equations",title:o.t("edtr-io::Equations"),description:o.t("edtr-io::Create mathematical equations and terms.")},{name:"image",title:o.t("edtr-io::Image"),description:o.t("edtr-io::Upload images."),icon:r.createIcon(r.faImages)},{name:"important",title:o.t("edtr-io::Important Statement"),description:o.t("edtr-io::A box to highlight important statements.")},{name:"injection",title:o.t("edtr-io::serlo.org Content"),description:o.t("edtr-io::Embed serlo.org content via their ID."),icon:r.createIcon(r.faNewspaper)},{name:"multimedia",title:o.t("edtr-io::Multimedia content associated with text"),description:o.t("edtr-io::Create an illustrating or explaining multimedia content associated with text."),icon:r.createIcon(r.faPhotoVideo)},{name:"spoiler",title:o.t("edtr-io::Spoiler"),description:o.t("edtr-io::A collapsible box."),icon:r.createIcon(r.faCaretSquareDown)},{name:"table",title:o.t("edtr-io::Table"),description:o.t("edtr-io::Create tables using Markdown.")},{name:"video",title:o.t("edtr-io::Video"),description:o.t("edtr-io::Embed YouTube, Vimeo, Wikimedia Commons or BR videos."),icon:r.createIcon(r.faFilm)}].concat(l?[{name:"separator",title:o.t("edtr-io::Solution Separator"),description:o.t("edtr-io::Divide the solution into individual steps.")}]:[])),i18n:o}),u=n.createDefaultDocumentEditor({i18n:{settings:{buttonLabel:o.t("edtr-io::Settings"),modalTitle:o.t("edtr-io::Extended Settings"),modalCloseLabel:o.t("edtr-io::Close")}}}),d=window.location.pathname.replace("add-revision","add-revision-old").replace("create","create-old");if(oe(c))switch(c.error){case"type-unsupported":return a.createElement("div",{className:"alert alert-danger",role:"alert"},o.t("edtr-io::This content type isn't supported by the new editor, yet.")," ",a.createElement("a",{href:d},o.t("edtr-io::Edit the content in the old editor.")));case"failure":return a.createElement("div",{className:"alert alert-danger",role:"alert"},o.t("edtr-io::An error occurred during the conversion.")," ",a.createElement("a",{href:d},o.t("edtr-io::Edit the content in the old editor.")))}var m=function(){var e=localStorage.getItem("edtr");if(e)return JSON.parse(e)[window.location.pathname]}();return m&&confirm(o.t("edtr-io::We found an old revision created by you. Do you want to restore it?"))&&(c={success:!0,initialState:m,converted:!1}),a.createElement(te.Provider,{value:e.getCsrfToken},a.createElement(sn.Provider,{value:{onSave:e.onSave,mayCheckout:e.mayCheckout}},c.converted?a.createElement("div",{className:"alert alert-warning",role:"alert"},o.t("edtr-io::This entity hasn't been converted to the new editor, yet.")," ",a.createElement("a",{href:d},o.t("edtr-io::Edit the content in the old editor."))):null,a.createElement(t.Editor,{DocumentEditor:u,onError:e.onError,plugins:s,initialState:c.initialState,editable:!0},e.children)))},exports.Renderer=function(e){var t=e.state,n=cn({getCsrfToken:function(){return""},registry:[],i18n:i.useI18n()});return a.createElement($.Renderer,{plugins:n,state:t||{plugin:"text"}})},exports.cleanEdtrState=function(e){return function e(t){return null!==t&&"object"==typeof t?c.map((function(t){if("text"===t.plugin&&t.state){var n=ee.Value.fromJSON(Z.serializer.deserialize(t.state));return ne({},t,{state:Z.slateValueToHtml(n)})}return e(t)}),t):t}(e)},exports.createPlugins=cn;
//# sourceMappingURL=edtr-io.cjs.production.min.js.map
